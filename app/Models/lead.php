<?php

namespace App\Models;

use Jenssegers\Mongodb\Eloquent\Model as Eloquent;

class Lead extends Eloquent
{
    protected $connection = 'mongodb';
    protected $collection = "leads";

    // protected $fieldMapping = ['fn' => 'First Name','ln' => 'Last Name','em' => 'Email','ph' => 'Phone','mb' => 'Mobile','sec_em' => 'Secondary Email','stu_gid' => 'Student Dummy Gmail ID','stu_pass' => 'Student Dummy Gmail Password','em_con' => 'Emergency Contact Details','ld_src' => 'Lead Source','ld_cat' => 'Lead Category','ld_typ' => 'Lead Type','ld_flg' => 'Lead Flag','ld_st' => 'Lead Status','ld_pri' => 'Lead Priority','re_cnt' => 'Revisit Count','rc_ld' => 'Re-churn Lead','ld_shr' => 'Lead Sharing','con_st' => 'Contact Stage','ld_scr' => 'Lead Score','ld_sel' => 'Lead Selling','cnt_in' => 'Count Interested','cr_by' => 'Created By','md_by' => 'Modified By','prev_ow' => 'Previous Contact Owner','stu_ls' => 'Student Lost (Yes/No)','stu_ls_st' => 'Student Lost After Which Stage','stu_ls_rs' => 'Student Lost Reason','nw_res' => 'Non-Workable Reason','stu_st' => 'Student Status','temp_ow' => 'Temp Contact Owner','upd_ld' => 'Updated Lead_ID','int_ld' => 'International Lead','of_cnt' => 'Offer Letter Count','otp_vf' => 'OTP Verified Lead','id' => 'Lead_ID','l2_cd' => 'L2 Call Disposition','l2_disp' => 'L2 Disposition','pg_lnk' => 'Page Link','act_pri' => 'Actual Priority','evt_atd' => 'Event Attendee','fair_id' => 'Fair ID','fair_qr' => 'Fair QR Code Link','utm_src' => 'UTM Source','new_prc' => 'New Process','auto_up' => 'Auto Update','frm_pg' => 'From_Page','pg_cat' => 'Page Category','pg_typ' => 'Page Type','rmks' => 'Remarks','utm_cmp' => 'UTM Campaign','has_ps' => 'Has Passport','cntry_pref' => 'Country Preference','pref_cn2' => 'Preferred Country of Study (2nd)','uni_fin' => 'University Finalized','uni_fd' => 'University Finalized Date','docs_st' => 'Documents Status','uni_sl' => 'University Shortlist Link','temp_sl' => 'Temporary Shortlist Shared','pref_crs' => 'Preferred Course of Study','pref_itk' => 'Preferred Intake','pref_ss' => 'Preferred Stream of Study','pref_cn_cd' => 'Preferred Country of Study (CD Form)','fund_src' => 'Source of Fund','pr_visa' => 'Prior Visa Information','usp_prs' => 'USP Presented Mode','uni_sd' => 'University Finalized','uni_sl_date' => 'University Shortlist Date','oth_cn' => 'Others Country','land_cn' => 'Landing Page Country','pref_uni' => 'Preferred Universities','uni_list' => 'List of University Finalized','brw_pref' => 'Browsing and Preference Match','prim_cn' => 'Primary Country of Preference','gre_scr' => 'GRE Score','gmat_scr' => 'GMAT Score','ielts_scr' => 'IELTS Score','sat_scr' => 'SAT Score','pte_scr' => 'PTE Score','toefl_scr' => 'TOEFL Score','det_scr' => 'DET Score','exm_bkd' => 'Exams Booked','exm_bd' => 'Exam Booked Date','loan_date' => 'Loan Required Date','last_act' => 'Last Activity Date/Time','last_call' => 'Last Call Attempted Date','last_con' => 'Last Call Connected Date','last_fup' => 'Last Follow Up - Date','fup_mark' => 'Follow up Marking Date','con_dt' => 'Contact Datetime','det_prof' => 'Detailed Profiling Date','lt_revisit' => 'Latest Revisit Date','ld_sell_up' => 'Lead Selling Updated Date','stu_ls_date' => 'Student Lost Date','uni_f_date' => 'University Finalised Date','uni_sl_date' => 'University Shortlist Date','assign_dt' => 'Assigning Datetime','shrt_pres_date' => 'Shortlist Presented Date','10th_sch' => '10th School','12th_sch' => '12th School','grad_crs' => 'Graduation Course Done','grad_ss' => 'Graduation Stream Done','pg_crs' => 'PG Course Done','pg_ss' => 'PG Stream Done','pct_10th' => 'Percentage in 10th','pct_12th' => 'Percentage in 12th','pct_grad' => 'Percentage in Graduation','pct_pg' => 'Percentage in PG','gap_yrs' => 'Enter Gap Years If Any','backlogs' => 'Backlogs','wrk_exp' => 'Work Experience','wrk_prof' => 'Work Ex Profile','grad_uni' => 'Graduation University','pg_uni' => 'PG_University','high_edu' => 'Highest Level of Education','grad_yr' => 'Year of Graduation','pg_yr' => 'Year of PG','eng_10' => '10th English Marks','10th_py' => '10th Passed Year','10th_bd' => '10th Board','12th_bd' => '12th Board','eng_12' => '12th English Marks','12th_py' => '12th Passed Year','12th_ss' => '12th Stream','con_ow' => 'Contact Owner','con_ow_em' => 'Contact Owner Email','con_ow_mb' => 'Contact Owner Mobile','con_ow_pod' => 'Contact Owner POD','app_poc' => 'App POC','prev_ow' => 'Previous Contact Owner','ld_ow_pod' => 'Lead Owner POD','ld_ow' => 'Lead Owner','addr_cur' => 'Current Address','city' => 'Current City','state' => 'Current State','perm_addr' => 'Permanent/Passport Address','cntry' => 'Country','cntry_cd' => 'Country Code','ref_nm' => 'Referee Name','ref_em' => 'Referee Email','ref_mb' => 'Referee Mobile','loan_req' => 'Loan Required','loan_date' => 'Loan Required Date','budget' => 'Budget','src_fund' => 'Source of Self - Fund'
    // ];

    protected $fieldMapping = ['fn' => 'first_name','ln' => 'last_name','em' => 'email','ph' => 'phone','mb' => 'mobile','sec_em' => 'secondary_email','stu_gid' => 'student_dummy_gmail_id','stu_pass' => 'student_dummy_gmail_password','em_con' => 'emergency_contact_details','ld_src' => 'lead_source','ld_cat' => 'lead_category','ld_typ' => 'lead_type','ld_flg' => 'lead_flag','ld_st' => 'lead_status','ld_pri' => 'lead_priority','re_cnt' => 'revisit_count','rc_ld' => 're_churn_lead','ld_shr' => 'lead_sharing','con_st' => 'contact_stage','ld_scr' => 'lead_score','ld_sel' => 'lead_selling','cnt_in' => 'count_interested','cr_by' => 'created_by','md_by' => 'modified_by','prev_ow' => 'previous_contact_owner','stu_ls' => 'student_lost_yes_no','stu_ls_st' => 'student_lost_after_which_stage','stu_ls_rs' => 'student_lost_reason','nw_res' => 'non_workable_reason','stu_st' => 'student_status','temp_ow' => 'temp_contact_owner','upd_ld' => 'updated_lead_id','int_ld' => 'international_lead','of_cnt' => 'offer_letter_count','otp_vf' => 'otp_verified_lead','id' => 'lead_id','l2_cd' => 'l2_call_disposition','l2_disp' => 'l2_disposition','pg_lnk' => 'page_link','act_pri' => 'actual_priority','evt_atd' => 'event_attendee','fair_id' => 'fair_id','fair_qr' => 'fair_qr_code_link','utm_src' => 'utm_source','new_prc' => 'new_process','auto_up' => 'auto_update','frm_pg' => 'from_page','pg_cat' => 'page_category','pg_typ' => 'page_type','rmks' => 'remarks','utm_cmp' => 'utm_campaign','has_ps' => 'has_passport','cntry_pref' => 'country_preference','pref_cn2' => 'preferred_country_of_study_2nd','uni_fin' => 'university_finalized','uni_fd' => 'university_finalized_date','docs_st' => 'documents_status','uni_sl' => 'university_shortlist_link','temp_sl' => 'temporary_shortlist_shared','pref_crs' => 'preferred_course_of_study','pref_itk' => 'preferred_intake','pref_ss' => 'preferred_stream_of_study','pref_cn_cd' => 'preferred_country_of_study_cd_form','fund_src' => 'source_of_fund','pr_visa' => 'prior_visa_information','usp_prs' => 'usp_presented_mode','uni_sd' => 'university_finalized','uni_sl_date' => 'university_shortlist_date','oth_cn' => 'others_country','land_cn' => 'landing_page_country','pref_uni' => 'preferred_universities','uni_list' => 'list_of_university_finalized','brw_pref' => 'browsing_and_preference_match','prim_cn' => 'primary_country_of_preference','gre_scr' => 'gre_score','gmat_scr' => 'gmat_score','ielts_scr' => 'ielts_score','sat_scr' => 'sat_score','pte_scr' => 'pte_score','toefl_scr' => 'toefl_score','det_scr' => 'det_score','exm_bkd' => 'exams_booked','exm_bd' => 'exam_booked_date','loan_date' => 'loan_required_date','last_act' => 'last_activity_date_time','last_call' => 'last_call_attempted_date','last_con' => 'last_call_connected_date','last_fup' => 'last_follow_up_date','fup_mark' => 'follow_up_marking_date','con_dt' => 'contact_datetime','det_prof' => 'detailed_profiling_date','lt_revisit' => 'latest_revisit_date','ld_sell_up' => 'lead_selling_updated_date','stu_ls_date' => 'student_lost_date','uni_f_date' => 'university_finalized_date','uni_sl_date' => 'university_shortlist_date','assign_dt' => 'assigning_datetime','shrt_pres_date' => 'shortlist_presented_date','10th_sch' => '10th_school','12th_sch' => '12th_school','grad_crs' => 'graduation_course_done','grad_ss' => 'graduation_stream_done','pg_crs' => 'pg_course_done','pg_ss' => 'pg_stream_done','pct_10th' => 'percentage_in_10th','pct_12th' => 'percentage_in_12th','pct_grad' => 'percentage_in_graduation','pct_pg' => 'percentage_in_pg','gap_yrs' => 'gap_years','backlogs' => 'backlogs','wrk_exp' => 'work_experience','wrk_prof' => 'work_ex_profile','grad_uni' => 'graduation_university','pg_uni' => 'pg_university','high_edu' => 'highest_level_of_education','grad_yr' => 'year_of_graduation','pg_yr' => 'year_of_pg','eng_10' => '10th_english_marks','10th_py' => '10th_passed_year','10th_bd' => '10th_board','12th_bd' => '12th_board','eng_12' => '12th_english_marks','12th_py' => '12th_passed_year','12th_ss' => '12th_stream','con_ow' => 'contact_owner','con_ow_em' => 'contact_owner_email','con_ow_mb' => 'contact_owner_mobile','con_ow_pod' => 'contact_owner_pod','app_poc' => 'app_poc','prev_ow' => 'previous_contact_owner','ld_ow_pod' => 'lead_owner_pod','ld_ow' => 'lead_owner','addr_cur' => 'current_address','city' => 'current_city','state' => 'current_state','perm_addr' => 'permanent_passport_address','cntry' => 'country','cntry_cd' => 'country_code','ref_nm' => 'referee_name','ref_em' => 'referee_email','ref_mb' => 'referee_mobile','loan_req' => 'loan_required','loan_date' => 'loan_required_date','budget' => 'budget','src_fund' => 'source_of_self_fund'
    ];
    
    

    protected $fillable = ['fn', 'ln', 'em', 'ph', 'mb', 'sec_em', 'stu_gid', 'stu_pass', 'em_con', 'ld_src', 'ld_cat', 'ld_typ','ld_flg', 'ld_st', 'ld_pri', 're_cnt', 'rc_ld', 'ld_shr', 'con_st', 'ld_scr', 'ld_sel', 'cnt_in','cr_by', 'md_by', 'prev_ow', 'stu_ls', 'stu_ls_st', 'stu_ls_rs', 'nw_res', 'stu_st', 'temp_ow','upd_ld', 'int_ld', 'of_cnt', 'otp_vf', 'id', 'l2_cd', 'l2_disp', 'pg_lnk', 'act_pri', 'evt_atd','fair_id', 'fair_qr', 'utm_src', 'new_prc', 'auto_up', 'frm_pg', 'pg_cat', 'pg_typ', 'rmks', 'utm_cmp','has_ps', 'cntry_pref', 'pref_cn2', 'uni_fin', 'uni_fd', 'docs_st', 'uni_sl', 'temp_sl', 'pref_crs','pref_itk', 'pref_ss', 'pref_cn_cd', 'fund_src', 'pr_visa', 'usp_prs', 'uni_sd', 'uni_sl_date', 'oth_cn','land_cn', 'pref_uni', 'uni_list', 'brw_pref', 'prim_cn', 'gre_scr', 'gmat_scr', 'ielts_scr', 'sat_scr','pte_scr', 'toefl_scr', 'det_scr', 'exm_bkd', 'exm_bd', 'loan_date', 'last_act', 'last_call', 'last_con','last_fup', 'fup_mark', 'con_dt', 'det_prof', 'lt_revisit', 'ld_sell_up', 'stu_ls_date', 'uni_f_date','uni_sl_date', 'assign_dt', 'shrt_pres_date', '10th_sch', '12th_sch', 'grad_crs', 'grad_ss', 'pg_crs','pg_ss', 'pct_10th', 'pct_12th', 'pct_grad', 'pct_pg', 'gap_yrs', 'backlogs', 'wrk_exp', 'wrk_prof','grad_uni', 'pg_uni', 'high_edu', 'grad_yr', 'pg_yr', 'eng_10', '10th_py', '10th_bd', '12th_bd', 'eng_12','12th_py', '12th_ss', 'con_ow', 'con_ow_em', 'con_ow_mb', 'con_ow_pod', 'app_poc', 'prev_ow', 'ld_ow_pod','ld_ow', 'addr_cur', 'city', 'state', 'perm_addr', 'cntry', 'cntry_cd', 'ref_nm', 'ref_em', 'ref_mb','loan_req', 'loan_date', 'budget', 'src_fund'
    ];
    

    public function getAttributesArray()
    {
        $mongoKeys = array_values($this->fieldMapping);
        $attributes = $this->only($mongoKeys);

        return array_flip($this->fieldMapping) ? array_combine(
            array_flip($this->fieldMapping),
            array_intersect_key($attributes, array_flip($this->fieldMapping))
        ) : $attributes;
    }

    public function getAttribute($key)
    {
        $mongoKey = $this->fieldMapping[$key] ?? $key;
        return parent::getAttribute($mongoKey);
    }

    public function setAttribute($key, $value)
    {
        $mongoKey = $this->fieldMapping[$key] ?? $key;
        parent::setAttribute($mongoKey, $value);
    }
}
